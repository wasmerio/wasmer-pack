<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js rust">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>WebAssembly Interfaces (WAI) - Wasmer Pack User Guide</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "rust";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><a href="../../index.html">Wasmer Pack</a></li><li class="chapter-item affix "><a href="../../quickstart.html">Quickstart Guide</a></li><li class="chapter-item affix "><li class="part-title">Tutorial</li><li class="chapter-item "><a href="../../tutorial/01-hello-world.html">Hello, World!</a></li><li class="chapter-item "><a href="../../tutorial/02-strings-and-lists.html">Strings and Lists</a></li><li class="chapter-item "><a href="../../tutorial/03-records.html">Records</a></li><li class="chapter-item "><div>Variants</div></li><li class="chapter-item "><a href="../../tutorial/05-resources.html">Exposing Resources</a></li><li class="chapter-item "><div>Importing Host Functions</div></li><li class="chapter-item "><div>Doing IO with WASI</div></li><li class="chapter-item "><div>Commands</div></li><li class="chapter-item "><div>Writing Guests in C</div></li><li class="chapter-item "><div>Tantivy</div></li><li class="chapter-item "><div>Integrating Tantivy with a React App</div></li><li class="chapter-item affix "><li class="part-title">Concepts</li><li class="chapter-item expanded "><a href="../../concepts/wai/index.html" class="active">WebAssembly Interfaces (WAI)</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../concepts/wai/types.html">Builtin Types</a></li><li class="chapter-item "><a href="../../concepts/wai/functions.html">Functions</a></li><li class="chapter-item "><a href="../../concepts/wai/records.html">Records</a></li><li class="chapter-item "><a href="../../concepts/wai/variants.html">Enums, Flags, Variants, and Unions</a></li><li class="chapter-item "><a href="../../concepts/wai/resources.html">Resources</a></li></ol></li><li class="chapter-item "><li class="part-title">How-To Guides</li><li class="chapter-item "><a href="../../how-to/resources-vs-records.html">Choosing Between Resources and Records</a></li><li class="chapter-item affix "><li class="part-title">For Developers</li><li class="chapter-item "><a href="../../contributing.html">Contributing Guide</a></li><li class="chapter-item "><a href="../../architecture/index.html">Project Architecture</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../architecture/001-generated-package-naming.html">001 Generated Package Naming</a></li><li class="spacer"></li></ol></li><li class="chapter-item "><a href="../../changelog.html">Changelog</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Wasmer Pack User Guide</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/wasmerio/wasmer-pack" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/wasmerio/wasmer-pack/edit/master/doc/./concepts/wai/README.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="webassembly-interfaces-wai"><a class="header" href="#webassembly-interfaces-wai">WebAssembly Interfaces (WAI)</a></h1>
<p>The WebAssembly spec that was first released in 2017 was only a minimum viable
product and deliberately left several features incomplete to be iterated on by
the ecosystem.</p>
<p>Arguably the most important functionality gap is the fact that only WebAssembly
primitives can be passed between the host and guest. That means imports and
exports can only use the following data types,</p>
<ul>
<li><code>i32</code> - signed 32-bit integers</li>
<li><code>i64</code> - signed 64-bit integers</li>
<li><code>f32</code> - a 32-bit float</li>
<li><code>f64</code> - a 64-bit float (often called a <code>double</code>)</li>
<li><code>funcref</code> - a reference to a WebAssembly function</li>
<li><code>externref</code> - a reference to some opaque object owned by the WebAssembly
virtual machine</li>
</ul>
<p>You'll notice this list doesn't even include strings or boolean values!</p>
<p>The WebAssembly Interfaces project (WAI for short) provides a polyfill for
passing around higher-level objects. It lets developers define their imports and
exports in a <code>*.wai</code> file, then uses <code>wai-bindgen</code> to generate glue which
automagically passes things around within the constraints of WebAssembly.</p>
<p>There are four main parts to WAI:</p>
<ul>
<li>The <code>*.wai</code> file</li>
<li>The WAI Bindgen code generator</li>
<li>The guest</li>
<li>The host</li>
</ul>
<p>The <a href="../../">Wasmer Pack</a> project provides a convenient way to consume
WebAssembly packages which implement a WAI interface.</p>
<p>Some useful links:</p>
<ul>
<li><a href="https://github.com/wasmerio/wai">The <code>wasmerio/wai</code> repository</a></li>
<li><a href="https://github.com/wasmerio/wai/blob/main/WAI.md">The <code>*.wai</code> format</a></li>
<li><a href="https://crates.io/crates/wai-bindgen-cli">The <code>wai-bindgen</code> CLI on crates.io</a></li>
</ul>
<h2 id="the-wai-file"><a class="header" href="#the-wai-file">The <code>*.wai</code> File</a></h2>
<p>WAI uses a file (or files) with the <code>*.wai</code> extension to define the host-guest
interface for an application that uses WebAssembly.</p>
<p>The items in a <code>*.wai</code> file map closely to concepts shared by most programming
languages. It has <a href="./types.html">types</a>, interfaces
(<a href="./resources.html">&quot;Resources&quot;</a>), structs (<a href="./records.html">&quot;Records&quot;</a>),
<a href="./functions.html">functions</a>, <a href="./variants.html">enums</a>, and so on.</p>
<p>The precise syntax <a href="https://github.com/wasmerio/wai/blob/main/WAI.md">is defined in the WAI repository</a> and a parser,
<a href="https://docs.rs/wai-parser"><code>wai-parser</code></a>, is available as a Rust crate.</p>
<h2 id="the-guest"><a class="header" href="#the-guest">The Guest</a></h2>
<p>In an application using WebAssembly, the &quot;guest&quot; is the code that has been
compiled to WebAssembly and is being loaded into a WebAssembly virtual machine.</p>
<h2 id="the-host"><a class="header" href="#the-host">The Host</a></h2>
<p>In an application using WebAssembly, the &quot;host&quot; is the code that uses a
WebAssembly virtual machine (like <a href="https://docs.rs/wasmer"><code>wasmer</code></a>) to load a guest and use
functionality it provides.</p>
<p>The WebAssembly spec refers to the host in some places as
<a href="https://webassembly.github.io/spec/core/intro/overview.html#embedder"><em>the embedder</em></a>.</p>
<h2 id="wai-bindgen"><a class="header" href="#wai-bindgen">WAI Bindgen</a></h2>
<p>The WAI Bindgen code generator consumes <code>*.wai</code> files and generates glue code
that <a href="#the-host">the host</a> can use for using functionality from a WebAssembly
module or <a href="#the-guest">the guest</a> can use for implementing that functionality.</p>
<p>There are two primary ways users will interact with WAI Bindgen, the
<code>wai-bindgen</code> CLI, and the <code>wai-bindgen-*</code> family of crates.</p>
<p>The <code>wai-bindgen</code> CLI provides a command-line interface to the <code>wai-bindgen-*</code>
crates, and is often used for once-off investigation or integration with a
non-Rust build system.</p>
<p>On the other hand, the <code>wai-bindgen-*</code> crates allow users to generate bindings
programmatically and give them much more control over the generation process.</p>
<div class="table-wrapper"><table><thead><tr><th>Language</th><th>Direction</th><th>Code Generator</th><th>Procedural Macro</th></tr></thead><tbody>
<tr><td>Rust</td><td>Guest</td><td><a href="https://docs.rs/wai-bindgen-gen-rust-wasm/"><code>wai-bindgen-gen-rust-wasm</code></a></td><td><a href="https://docs.rs/wai-bindgen-rust/"><code>wai-bindgen-rust</code></a></td></tr>
<tr><td>Rust</td><td>Host (Wasmer)</td><td><a href="https://docs.rs/wai-bindgen-gen-wasmer/"><code>wai-bindgen-gen-wasmer</code></a></td><td><a href="https://docs.rs/wai-bindgen-wasmer/"><code>wai-bindgen-wasmer</code></a></td></tr>
<tr><td>Rust</td><td>Host (Wasmtime)</td><td><a href="https://docs.rs/wai-bindgen-gen-wasmtime/"><code>wai-bindgen-gen-wasmtime</code></a></td><td><a href="https://docs.rs/wai-bindgen-wasmtime/"><code>wai-bindgen-wasmtime</code></a></td></tr>
<tr><td>C</td><td>Guest</td><td><a href="https://docs.rs/wai-bindgen-gen-c/"><code>wai-bindgen-gen-c</code></a></td><td></td></tr>
<tr><td>JavaScript</td><td>Host</td><td><a href="https://docs.rs/wai-bindgen-gen-js/"><code>wai-bindgen-gen-js</code></a></td><td></td></tr>
<tr><td>Python</td><td>Host (Wasmer)</td><td><a href="https://docs.rs/wai-bindgen-gen-wasmer-py/"><code>wai-bindgen-gen-wasmer-py</code></a></td><td></td></tr>
<tr><td>Python</td><td>Host (Wasmtime)</td><td><a href="https://docs.rs/wai-bindgen-gen-wasmtime-py/"><code>wai-bindgen-gen-wasmtime-py</code></a></td><td></td></tr>
</tbody></table>
</div>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../tutorial/05-resources.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../../concepts/wai/types.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../tutorial/05-resources.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../../concepts/wai/types.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
